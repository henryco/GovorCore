#!/bin/bash
#
#	Ubuntu based linux install script
#	JAVA8+ requested, also linux ubuntu request installed javafx libraries.
#	With any questions, please contact with me: hd2files@{google.mail}
#	Check me on GitHub: https://github.com/henryco


DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
rdme=$DIR"/README.txt"
conf=$DIR"/bin/config.struct"
runCl=$DIR"/bin/RunClient.sh"
runSc=$DIR"/bin/RunServer.sh"
runSg=$DIR"/bin/RunServerGui.sh"
tmpDt=$DIR"/bin/tempData.struct"
clt=$DIR"/client.sh"
srv=$DIR"/server.sh"
srg=$DIR"/server-gui.sh"


sudo apt-get install software-properties-common
sudo apt-get install openjdk-8-jre-headless
sudo apt-get install openjfx
sudo chmod a+x "$DIR"/bin/GovorCore.jar



echo "// Autogenerated escapy class loader template" > $conf
echo "// Created by @HenryCo in 2k16" >> $conf
echo "// https://github.com/henryco" >> $conf
echo "// hd2files@{google.mail}" >> $conf
echo "" >> $conf
echo "#import struct" >> $conf
echo "#sugar string java.lang.String" >> $conf
echo "" >> $conf
echo "var {" >> $conf
echo "" >> $conf
echo "}" >> $conf
echo "" >> $conf
echo "" >> $conf
echo "Enter {" >> $conf
echo "" >> $conf
echo "	Config([string, \"client\"], [string, \"SKChat\"]);" >> $conf
echo "	Config --> function {" >> $conf
echo "		setDataBase([string, \"struct\"], [string, \"tempData.struct\"]);" >> $conf
echo "		setIP([string, \"127.0.0.1\"], [string, \"80\"]);" >> $conf
echo "		setServerPort([int, 80]);" >> $conf
echo "	}" >> $conf
echo "	Config --> field {" >> $conf
echo "		wellcomeMessage = \"MACINTOSH PLUS - リサフランク420 / 現代のコンピュー\" " >> $conf
echo "		guiTitle \"SKChat\"" >> $conf
echo "		serverDebug false" >> $conf
echo "	}" >> $conf
echo "	Config.package: \"conf\"" >> $conf
echo "}" >> $conf



echo "#!/bin/bash" > $runCl
echo "#" >> $runCl
echo "#	linux chat client start script" >> $runCl
echo "#	@author HenryCo " >> $runCl
echo "#	github { https://github.com/henryco }" >> $runCl
echo "#	contact {hd2files@google_mail}" >> $runCl
echo "#" >> $runCl
echo "#	START ARGS:" >> $runCl
echo "#	[loc_path] [mode] [ip] [port]" >> $runCl
echo "#	[loc_path] [mode]" >> $runCl
echo "#	[loc_path]" >> $runCl
echo "#	[*void*]" >> $runCl
echo "" >> $runCl
echo "" >> $runCl
echo 'DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"' >> $runCl
echo 'java -jar "$DIR"/GovorCore.jar "$DIR"/ client # --> client args here <-- #' >> $runCl
sudo chmod a+x $runCl



echo "#!/bin/bash" > $runSc
echo "#" >> $runSc
echo "#	linux chat server start script" >> $runSc
echo "#	@author HenryCo " >> $runSc
echo "#	github { https://github.com/henryco }" >> $runSc
echo "#	contact {hd2files@google_mail}" >> $runSc
echo "#" >> $runSc
echo "#	START ARGS:" >> $runSc
echo "#	[loc_path] [mode] [db_type] [db_path]" >> $runSc
echo "#	[loc_path] [mode]" >> $runSc
echo "#	[loc_path]" >> $runSc
echo "#	[*void*]" >> $runSc
echo "" >> $runSc
echo "" >> $runSc
echo 'DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"' >> $runSc
echo 'java -jar "$DIR"/GovorCore.jar "$DIR"/ server # --> server args here <-- #' >> $runSc
sudo chmod a+x $runSc



echo "#!/bin/bash" > $runSg
echo "#" >> $runSg
echo "#	linux chat server start script" >> $runSg
echo "#	@author HenryCo " >> $runSg
echo "#	github { https://github.com/henryco }" >> $runSg
echo "#	contact {hd2files@google_mail}" >> $runSg
echo "#" >> $runSg
echo "#	START ARGS:" >> $runSg
echo "#	[loc_path] [mode] [db_type] [db_path]" >> $runSg
echo "#	[loc_path] [mode]" >> $runSg
echo "#	[loc_path]" >> $runSg
echo "#	[*void*]" >> $runSg
echo "" >> $runSg
echo "" >> $runSg
echo 'DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"' >> $runSg
echo 'java -jar "$DIR"/GovorCore.jar "$DIR"/ server-gui # --> server args here <-- #' >> $runSg
sudo chmod a+x $runSg



echo '#import struct' > $tmpDt
echo '' >> $tmpDt
echo '//	This is "proxy" pseudo data base, but it works for first time.' >> $tmpDt
echo '//	Anyway, you can write custom adapter for real data base' >> $tmpDt
echo '//	using existing DB interface (see core/database for more).' >> $tmpDt
echo '' >> $tmpDt
echo 'data {' >> $tmpDt
echo '	123456789 {' >> $tmpDt
echo '		name: "Henry"' >> $tmpDt
echo '		pass: 123123' >> $tmpDt
echo '		contacts {' >> $tmpDt
echo '			0: 987654321' >> $tmpDt
echo '			1: 457782311' >> $tmpDt
echo '		}' >> $tmpDt
echo '		strangers {' >> $tmpDt
echo '			0: 345472423' >> $tmpDt
echo '		} ' >> $tmpDt
echo '	}' >> $tmpDt
echo '	987654321("Henryco", 01210, contacts(123456789, 457782311, 345472423))' >> $tmpDt
echo '	345472423("TESTED", 111222, contacts(987654321))' >> $tmpDt
echo '	457782311("ADMIN", 143465, contacts(987654321, 123456789), strangers(345472423))' >> $tmpDt
echo '}' >> $tmpDt



echo '#!/bin/bash' > $clt
echo 'DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"' >> $clt
echo '"$DIR"/bin/./RunClient.sh' >> $clt
sudo chmod a+x $clt



echo '#!/bin/bash' > $srv
echo 'DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"' >> $srv
echo '"$DIR"/bin/./RunServer.sh' >> $srv
sudo chmod a+x $srv



echo '#!/bin/bash' > $srg
echo 'DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"' >> $srg
echo '"$DIR"/bin/./RunServerGui.sh' >> $srg
sudo chmod a+x $srg



echo 'JAVA8+ requested, also linux ubuntu request installed javafx libraries.' > $rdme
echo 'With any questions, please contact with me: hd2files@{google.mail}' >> $rdme
echo 'Program also works on Win7, on Win8 and Win10 possible troubles with libraries.' >> $rdme
echo 'To run on window you need to configure "config.struct" file before, and then run GovorCore.jar' >> $rdme
echo 'If you use linux, then run installation script, it will download and install requested ' >> $rdme
echo 'libraries, and create runnable start scrpits for client and server version. ' >> $rdme

